"""
Ù…Ø­Ø±Ùƒ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ù„ÙƒØ´Ù Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„
Rule-based fraud detection - Ù…Ø­Ø³Ù‘Ù†!
"""

# Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø© Ù…Ø¹ Ø£ÙˆØ²Ø§Ù†Ù‡Ø§ (Ù…Ø­Ø¯Ù‘Ø«!)
KEYWORDS = {
    # ===== Ø·Ù„Ø¨ OTP ÙˆØ±Ù…ÙˆØ² (Ø®Ø·ÙŠØ± Ø¬Ø¯Ø§Ù‹!) =====
    "otp": 45, "OTP": 45,
    "Ø±Ù…Ø²": 30, "Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚": 40, "Ø±Ù…Ø² Ø§Ù„Ø§Ù…Ø§Ù†": 40, "Ø±Ù…Ø² Ø§Ù„Ø£Ù…Ø§Ù†": 40,
    "ÙƒÙˆØ¯": 30, "ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„": 40, "ÙƒÙˆØ¯ Ø§Ù„ØªØ­Ù‚Ù‚": 40,
    "Ø§Ø±Ø³Ù„ Ø§Ù„Ø±Ù…Ø²": 45, "Ø§Ø±Ø³Ù„ÙŠ Ø§Ù„Ø±Ù…Ø²": 45,
    "Ø§Ø±Ø³Ù„ Ø±Ù‚Ù…": 35, "Ø§Ø±Ø³Ù„ÙŠ Ø±Ù‚Ù…": 35, "Ø£Ø±Ø³Ù„ Ø±Ù‚Ù…": 35, "Ø£Ø±Ø³Ù„ÙŠ Ø±Ù‚Ù…": 35,
    
    # ===== Ø§Ù†ØªØ­Ø§Ù„ Ø§Ù„Ù…Ø¯ÙŠØ±/Ø§Ù„Ø´Ø±ÙƒØ© (Ù…Ù‡Ù…!) =====
    "Ø§Ù†Ø§ Ù…Ø¯ÙŠØ±Ùƒ": 50, "Ø£Ù†Ø§ Ù…Ø¯ÙŠØ±Ùƒ": 50, "Ù…Ø¯ÙŠØ±Ùƒ": 40,
    "Ø§Ù†Ø§ Ø§Ù„Ù…Ø¯ÙŠØ±": 45, "Ø£Ù†Ø§ Ø§Ù„Ù…Ø¯ÙŠØ±": 45,
    "Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ": 40, "Ø§Ù„Ø±Ø¦ÙŠØ³ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ": 40,
    "Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¯ÙŠØ±": 40, "Ù…Ø¯ÙŠØ±Ùƒ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„": 45,
    
    # ===== Ø§Ù†ØªØ­Ø§Ù„ Ø§Ù„Ø¨Ù†ÙˆÙƒ =====
    "Ù…Ù† Ø§Ù„Ø¨Ù†Ùƒ": 35, "Ù…Ù† Ø¨Ù†Ùƒ": 35, "Ø§Ù†Ø§ Ù…Ù† Ø¨Ù†Ùƒ": 45, "Ø£Ù†Ø§ Ù…Ù† Ø¨Ù†Ùƒ": 45,
    "Ø¨Ù†Ùƒ Ø§Ù„ØªÙ†Ù…ÙŠØ©": 30, "Ø¨Ù†Ùƒ Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ": 25, "Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ": 25,
    "Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø§Ù‡Ù„ÙŠ": 25, "Ø¨Ù†Ùƒ Ø§Ù„Ø§Ù†Ù…Ø§Ø¡": 25,
    "Ù…ÙˆØ¸Ù Ø§Ù„Ø¨Ù†Ùƒ": 40, "Ù…Ù…Ø«Ù„ Ø§Ù„Ø¨Ù†Ùƒ": 40, "Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡": 25,
    "Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ": 30, "Ù…Ù† Ø§Ù„Ø¯Ø¹Ù…": 30,
    
    # ===== Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø© =====
    "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ": 45, "Ø±Ù‚Ù…Ùƒ Ø§Ù„Ø³Ø±ÙŠ": 45,
    "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±": 40, "ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±": 40, "Ø¨Ø§Ø³ÙˆØ±Ø¯": 40,
    "Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©": 40, "Ø±Ù‚Ù… Ø¨Ø·Ø§Ù‚ØªÙƒ": 40,
    "cvv": 50, "CVV": 50, "cvc": 50, "CVC": 50,
    "pin": 40, "PIN": 40,
    "Ø¨ÙŠØ§Ù†Ø§ØªÙƒ": 30, "Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ": 25,
    "Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©": 30, "Ø±Ù‚Ù… Ù‡ÙˆÙŠØªÙƒ": 30,
    
    # ===== ØªÙ‡Ø¯ÙŠØ¯ Ø¨Ø¥ÙŠÙ‚Ø§Ù =====
    "Ø¥ÙŠÙ‚Ø§Ù": 30, "Ø§ÙŠÙ‚Ø§Ù": 30, "ØªØ¬Ù…ÙŠØ¯": 30, "Ø¥ØºÙ„Ø§Ù‚": 30, "Ø­Ø¸Ø±": 30,
    "Ø³ÙŠØªÙ… Ø¥ÙŠÙ‚Ø§Ù": 40, "Ø³ÙŠØªÙ… Ø§ÙŠÙ‚Ø§Ù": 40, "Ø³ÙŠØªÙ… ØªØ¬Ù…ÙŠØ¯": 40,
    "ØªÙ… Ø¥ÙŠÙ‚Ø§Ù": 35, "ØªÙ… Ø§ÙŠÙ‚Ø§Ù": 35, "ØªÙ… ØªØ¬Ù…ÙŠØ¯": 35,
    "Ø­Ø³Ø§Ø¨Ùƒ Ù…ÙˆÙ‚ÙˆÙ": 45, "Ø¨Ø·Ø§Ù‚ØªÙƒ Ù…ÙˆÙ‚ÙˆÙØ©": 45,
    "Ù…Ø¹Ø±Ø¶ Ù„Ù„Ø¥ØºÙ„Ø§Ù‚": 35, "Ø³ÙŠØºÙ„Ù‚": 30,
    
    # ===== Ø§Ø³ØªØ¹Ø¬Ø§Ù„ =====
    "ÙÙˆØ±Ø§Ù‹": 25, "ÙÙˆØ±Ø§": 25, "Ø§Ù„Ø¢Ù†": 20, "Ø§Ù„Ø§Ù†": 20, "Ø¹Ø§Ø¬Ù„": 25,
    "Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©": 30, "Ø®Ù„Ø§Ù„ Ø³Ø§Ø¹Ø©": 35, "Ù‚Ø¨Ù„ ÙÙˆØ§Øª Ø§Ù„Ø£ÙˆØ§Ù†": 30,
    "Ø¨Ø³Ø±Ø¹Ø©": 20, "Ø­Ø§Ù„Ø§Ù‹": 25, "Ø­Ø§Ù„Ø§": 25, "Ù…Ø³ØªØ¹Ø¬Ù„": 25,
    "Ø¢Ø®Ø± ÙØ±ØµØ©": 30, "Ø§Ø®Ø± ÙØ±ØµØ©": 30,
    
    # ===== Ø·Ù„Ø¨ Ù…Ø§Ù„ =====
    "ØªØ­ÙˆÙŠÙ„": 25, "Ø­ÙˆÙ„": 20, "Ø­ÙˆÙ„ÙŠ": 35, "Ø­ÙˆÙ‘Ù„": 25, "Ø­ÙˆÙ‘Ù„ÙŠ": 35,
    "Ø§Ø±Ø³Ù„": 20, "Ø§Ø±Ø³Ù„ÙŠ": 25, "Ø£Ø±Ø³Ù„": 20, "Ø£Ø±Ø³Ù„ÙŠ": 25,
    "Ø³Ù„ÙÙ†ÙŠ": 40, "Ø³Ù„ÙØ©": 35, "Ù‚Ø±Ø¶": 25,
    "Ù…Ø­ØªØ§Ø¬ ÙÙ„ÙˆØ³": 40, "Ù…Ø­ØªØ§Ø¬ Ù…Ø¨Ù„Øº": 40,
    
    # ===== Ø¬ÙˆØ§Ø¦Ø² ÙˆÙ‡Ù…ÙŠØ© =====
    "Ø±Ø¨Ø­Øª": 40, "ÙØ²Øª": 40, "Ù…Ø¨Ø±ÙˆÙƒ": 30, "ØªÙ‡Ø§Ù†ÙŠÙ†Ø§": 30,
    "Ø¬Ø§Ø¦Ø²Ø©": 35, "Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„": 45, "Ø§Ù„Ù Ø±ÙŠØ§Ù„": 30,
    "ØªÙ… Ø§Ø®ØªÙŠØ§Ø±Ùƒ": 35, "Ø§Ù†Øª Ø§Ù„ÙØ§Ø¦Ø²": 45,
    "Ø³Ø­Ø¨ Ø¹Ø´ÙˆØ§Ø¦ÙŠ": 35,
    
    # ===== Ø§Ù†ØªØ­Ø§Ù„ Ø´Ø®ØµÙŠØ© =====
    "Ø®ÙˆÙŠÙƒ": 35, "ØµØ§Ø­Ø¨Ùƒ": 35, "Ù‚Ø±ÙŠØ¨Ùƒ": 35, "Ø£Ø®ÙˆÙƒ": 35, "Ø§Ø®ÙˆÙƒ": 35,
    "Ù…Ø­ØªØ§Ø¬": 30, "Ù…Ø­ØªØ§Ø¬Ùƒ": 35, "Ø¶Ø±ÙˆØ±ÙŠ": 25,
    "ØµØ¯ÙŠÙ‚Ùƒ": 30, "Ø²Ù…ÙŠÙ„Ùƒ": 25,
    "Ø§Ù†Ø§ ØµØ§Ø­Ø¨Ùƒ": 40, "Ø£Ù†Ø§ ØµØ§Ø­Ø¨Ùƒ": 40,
    
    # ===== Ø­Ø³Ø§Ø¨Ø§Øª ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§Øª =====
    "Ø­Ø³Ø§Ø¨Ùƒ": 25, "Ø¨Ø·Ø§Ù‚ØªÙƒ": 25,
    "Ø­Ø³Ø§Ø¨Ùƒ Ø§Ù„Ø¨Ù†ÙƒÙŠ": 30, "Ø¨Ø·Ø§Ù‚ØªÙƒ Ø§Ù„Ø¨Ù†ÙƒÙŠØ©": 30,
    "ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§ØªÙƒ": 35, "ØªØ­Ø¯ÙŠØ« Ø­Ø³Ø§Ø¨Ùƒ": 35,
    
    # ===== Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ =====
    "urgent": 25, "immediately": 25, "asap": 25, "act now": 30,
    "suspended": 35, "blocked": 35, "locked": 35, "closed": 30,
    "verify": 30, "verification": 30, "confirm": 25,
    "password": 40, "passcode": 40,
    "your otp": 50, "send otp": 50, "verification code": 45,
    "i am your manager": 50, "this is your boss": 50, "ceo": 40,
    "from the bank": 35, "bank support": 35,
    "winner": 40, "lottery": 40, "congratulations": 35, "won": 35,
    "transfer": 30, "wire": 30, "send money": 35,
    "click here": 30, "click now": 30, "click the link": 35,
    
    # ===== Ø±ÙˆØ§Ø¨Ø· Ù…Ø´Ø¨ÙˆÙ‡Ø© =====
    ".xyz": 40, ".top": 40, ".click": 40, ".loan": 40,
    ".work": 35, ".online": 30, ".site": 30,
    "bit.ly": 35, "tinyurl": 35, "shorturl": 35,
}


def calculate_rule_score(text: str) -> int:
    """Ø­Ø³Ø§Ø¨ Ù†Ù‚Ø§Ø· Ø§Ù„Ø®Ø·Ø± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø§Øª"""
    score = 0
    text_lower = text.lower()
    
    for word, value in KEYWORDS.items():
        if word.lower() in text_lower:
            score += value
    
    return min(score, 100)


def detect_threat_type(text: str) -> str:
    """ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯"""
    text_lower = text.lower()
    
    # Ø§Ù†ØªØ­Ø§Ù„ Ù…Ø¯ÙŠØ±
    if any(w in text_lower for w in ["Ù…Ø¯ÙŠØ±Ùƒ", "Ø§Ù†Ø§ Ù…Ø¯ÙŠØ±Ùƒ", "Ø£Ù†Ø§ Ù…Ø¯ÙŠØ±Ùƒ", "Ø§Ù„Ù…Ø¯ÙŠØ±", "your manager", "boss", "ceo"]):
        return "Ø§Ù†ØªØ­Ø§Ù„ Ù…Ø¯ÙŠØ±/ØªÙ†ÙÙŠØ°ÙŠ"
    
    # Ø·Ù„Ø¨ OTP
    if any(w in text_lower for w in ["otp", "Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚", "ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„", "Ø±Ù…Ø² Ø§Ù„Ø§Ù…Ø§Ù†"]):
        return "Ø·Ù„Ø¨ Ø±Ù…Ø² ØªØ­Ù‚Ù‚ (OTP)"
    
    # Ø§Ù†ØªØ­Ø§Ù„ Ø¨Ù†Ùƒ
    if any(w in text_lower for w in ["Ù…Ù† Ø§Ù„Ø¨Ù†Ùƒ", "Ù…Ù† Ø¨Ù†Ùƒ", "Ø¨Ù†Ùƒ Ø§Ù„ØªÙ†Ù…ÙŠØ©", "Ù…ÙˆØ¸Ù Ø§Ù„Ø¨Ù†Ùƒ", "Ø¥ÙŠÙ‚Ø§Ù", "ØªØ¬Ù…ÙŠØ¯", "suspended"]):
        return "Ø§Ù†ØªØ­Ø§Ù„ ØµÙØ© Ø¨Ù†Ùƒ"
    
    # Ø·Ù„Ø¨ ÙƒÙ„Ù…Ø© Ø³Ø±
    if any(w in text_lower for w in ["Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ", "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", "ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±", "password", "cvv", "pin"]):
        return "Ø·Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø±ÙŠØ©"
    
    # Ø§Ø­ØªÙŠØ§Ù„ Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ
    if any(w in text_lower for w in ["Ø®ÙˆÙŠÙƒ", "ØµØ§Ø­Ø¨Ùƒ", "Ù‚Ø±ÙŠØ¨Ùƒ", "Ø£Ø®ÙˆÙƒ", "Ù…Ø­ØªØ§Ø¬", "Ø³Ù„ÙÙ†ÙŠ"]):
        return "Ø§Ø­ØªÙŠØ§Ù„ Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ"
    
    # Ø¬ÙˆØ§Ø¦Ø² ÙˆÙ‡Ù…ÙŠØ©
    if any(w in text_lower for w in ["Ø±Ø¨Ø­Øª", "Ø¬Ø§Ø¦Ø²Ø©", "Ù…Ø¨Ø±ÙˆÙƒ", "ÙØ²Øª", "winner", "lottery"]):
        return "Ø¬ÙˆØ§Ø¦Ø² ÙˆÙ‡Ù…ÙŠØ©"
    
    # Ø±ÙˆØ§Ø¨Ø· ØªØµÙŠØ¯
    if any(w in text_lower for w in [".xyz", ".top", "bit.ly", "click here"]):
        return "ØªØµÙŠØ¯ Ø§Ø­ØªÙŠØ§Ù„ÙŠ"
    
    # Ø·Ù„Ø¨ ØªØ­ÙˆÙŠÙ„
    if any(w in text_lower for w in ["Ø­ÙˆÙ„", "Ø­ÙˆÙ„ÙŠ", "Ø§Ø±Ø³Ù„", "ØªØ­ÙˆÙŠÙ„", "transfer", "wire"]):
        return "Ø·Ù„Ø¨ ØªØ­ÙˆÙŠÙ„ Ù…Ø´Ø¨ÙˆÙ‡"
    
    return "Ø±Ø³Ø§Ù„Ø© Ø¹Ø§Ø¯ÙŠØ©"


def extract_flags(text: str) -> list:
    """Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù…ÙØµÙ„Ø©"""
    flags = []
    text_lower = text.lower()
    
    # Ø·Ù„Ø¨ OTP (Ø®Ø·ÙŠØ± Ø¬Ø¯Ø§Ù‹!)
    if any(w in text_lower for w in ["otp", "Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚", "ÙƒÙˆØ¯", "Ø±Ù…Ø² Ø§Ù„Ø§Ù…Ø§Ù†", "verification code"]):
        flags.append({
            "icon": "ðŸ”‘",
            "title": "Ø·Ù„Ø¨ Ø±Ù…Ø² OTP/ØªØ­Ù‚Ù‚",
            "description": "Ù„Ø§ ØªØ±Ø³Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ù„Ø£ÙŠ Ø´Ø®Øµ Ø£Ø¨Ø¯Ø§Ù‹!",
            "severity": "critical"
        })
    
    # Ø§Ù†ØªØ­Ø§Ù„ Ù…Ø¯ÙŠØ±
    if any(w in text_lower for w in ["Ù…Ø¯ÙŠØ±Ùƒ", "Ø§Ù†Ø§ Ù…Ø¯ÙŠØ±Ùƒ", "Ø£Ù†Ø§ Ù…Ø¯ÙŠØ±Ùƒ", "Ø§Ù„Ù…Ø¯ÙŠØ±", "manager", "boss", "ceo"]):
        flags.append({
            "icon": "ðŸ‘”",
            "title": "Ø§Ù†ØªØ­Ø§Ù„ ØµÙØ© Ù…Ø¯ÙŠØ±",
            "description": "Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ù† ÙŠØ·Ù„Ø¨ Ù…Ù†Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø±ÙŠØ©",
            "severity": "critical"
        })
    
    # Ø§Ù†ØªØ­Ø§Ù„ Ø¨Ù†Ùƒ
    if any(w in text_lower for w in ["Ù…Ù† Ø§Ù„Ø¨Ù†Ùƒ", "Ù…Ù† Ø¨Ù†Ùƒ", "Ø¨Ù†Ùƒ Ø§Ù„ØªÙ†Ù…ÙŠØ©", "Ù…ÙˆØ¸Ù Ø§Ù„Ø¨Ù†Ùƒ"]):
        flags.append({
            "icon": "ðŸ¦",
            "title": "Ø§Ù†ØªØ­Ø§Ù„ ØµÙØ© Ø¨Ù†Ùƒ",
            "description": "Ø§Ù„Ø¨Ù†ÙˆÙƒ Ù„Ø§ ØªØ·Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¹Ø¨Ø± Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„",
            "severity": "critical"
        })
    
    # Ø·Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø±ÙŠØ©
    if any(w in text_lower for w in ["Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ", "Ø±Ù‚Ù…Ùƒ Ø§Ù„Ø³Ø±ÙŠ", "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", "ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±", "password", "cvv", "pin"]):
        flags.append({
            "icon": "ðŸ”",
            "title": "Ø·Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø±ÙŠØ©",
            "description": "Ù„Ø§ ØªØ´Ø§Ø±Ùƒ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± Ø£Ùˆ CVV Ù…Ø¹ Ø£ÙŠ Ø£Ø­Ø¯",
            "severity": "critical"
        })
    
    # Ø§Ø³ØªØ¹Ø¬Ø§Ù„
    if any(w in text_lower for w in ["ÙÙˆØ±Ø§Ù‹", "ÙÙˆØ±Ø§", "Ø§Ù„Ø¢Ù†", "Ø¹Ø§Ø¬Ù„", "immediately", "urgent", "asap"]):
        flags.append({
            "icon": "â°",
            "title": "Ø§Ø³ØªØ¹Ø¬Ø§Ù„ ÙˆØ¶ØºØ·",
            "description": "Ø§Ù„Ù…Ø­ØªØ§Ù„ÙˆÙ† ÙŠØ¶ØºØ·ÙˆÙ† Ø¹Ù„ÙŠÙƒ Ù„Ù„ØªØµØ±Ù Ø¨Ø³Ø±Ø¹Ø©",
            "severity": "high"
        })
    
    # ØªÙ‡Ø¯ÙŠØ¯ Ø¨Ø¥ÙŠÙ‚Ø§Ù
    if any(w in text_lower for w in ["Ø¥ÙŠÙ‚Ø§Ù", "Ø§ÙŠÙ‚Ø§Ù", "ØªØ¬Ù…ÙŠØ¯", "suspended", "blocked", "locked"]):
        flags.append({
            "icon": "âš ï¸",
            "title": "ØªÙ‡Ø¯ÙŠØ¯ Ø¨Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø­Ø³Ø§Ø¨",
            "description": "Ø§Ù„Ø¨Ù†ÙˆÙƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„Ø§ ØªÙ‡Ø¯Ø¯ Ø¹Ø¨Ø± Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„",
            "severity": "high"
        })
    
    # Ø±ÙˆØ§Ø¨Ø· Ù…Ø´Ø¨ÙˆÙ‡Ø©
    if any(w in text_lower for w in [".xyz", ".top", "bit.ly", ".click", ".loan"]):
        flags.append({
            "icon": "ðŸ”—",
            "title": "Ø±Ø§Ø¨Ø· Ù…Ø´Ø¨ÙˆÙ‡",
            "description": "Ù†Ø·Ø§Ù‚Ø§Øª Ù…Ø´Ø¨ÙˆÙ‡Ø© ØªØ³ØªØ®Ø¯Ù… Ù„Ù„ØªØµÙŠØ¯",
            "severity": "critical"
        })
    
    # Ø¬ÙˆØ§Ø¦Ø²
    if any(w in text_lower for w in ["Ø±Ø¨Ø­Øª", "Ø¬Ø§Ø¦Ø²Ø©", "Ù…Ø¨Ø±ÙˆÙƒ", "winner", "lottery"]):
        flags.append({
            "icon": "ðŸŽ",
            "title": "Ø¬Ø§Ø¦Ø²Ø© ÙˆÙ‡Ù…ÙŠØ©",
            "description": "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¬ÙˆØ§Ø¦Ø² Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø¹Ø¨Ø± Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„",
            "severity": "high"
        })
    
    # Ø§Ù†ØªØ­Ø§Ù„ Ø´Ø®ØµÙŠØ©
    if any(w in text_lower for w in ["Ø®ÙˆÙŠÙƒ", "ØµØ§Ø­Ø¨Ùƒ", "Ø£Ø®ÙˆÙƒ", "ØµØ¯ÙŠÙ‚Ùƒ"]):
        flags.append({
            "icon": "ðŸ‘¤",
            "title": "Ø§Ù†ØªØ­Ø§Ù„ Ø´Ø®ØµÙŠØ© ØµØ¯ÙŠÙ‚",
            "description": "Ø´Ø®Øµ ÙŠØ¯Ù‘Ø¹ÙŠ Ù…Ø¹Ø±ÙØªÙƒ",
            "severity": "high"
        })
    
    # Ø·Ù„Ø¨ Ù…Ø§Ù„
    if any(w in text_lower for w in ["Ø­ÙˆÙ„", "Ø­ÙˆÙ„ÙŠ", "ØªØ­ÙˆÙŠÙ„", "Ø³Ù„ÙÙ†ÙŠ", "transfer", "Ø§Ø±Ø³Ù„"]):
        flags.append({
            "icon": "ðŸ’¸",
            "title": "Ø·Ù„Ø¨ ØªØ­ÙˆÙŠÙ„ Ù…Ø§Ù„",
            "description": "ØªØ£ÙƒØ¯ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ø·Ø§Ù„Ø¨ Ù‚Ø¨Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„",
            "severity": "high"
        })
    
    return flags


def get_actions(score: int, flags: list) -> list:
    """Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§"""
    if score < 40:
        return [{
            "icon": "âœ…",
            "action": "Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ÙŠØ¨Ø¯Ùˆ Ø¢Ù…Ù†Ø§Ù‹",
            "description": "Ù„ÙƒÙ† ØªØ£ÙƒØ¯ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø±Ø³Ù„"
        }]
    
    actions = [
        {"icon": "ðŸš«", "action": "Ù„Ø§ ØªØ¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ø±Ø§Ø¨Ø·", "description": "Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù…ÙˆÙ‚Ø¹ ØªØµÙŠØ¯"},
        {"icon": "ðŸ”’", "action": "Ù„Ø§ ØªØ´Ø§Ø±Ùƒ Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª", "description": "ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ§Ù„Ø±Ù…ÙˆØ² Ø³Ø±ÙŠØ©"},
    ]
    
    # Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯
    if any(f["title"] in ["Ø§Ù†ØªØ­Ø§Ù„ ØµÙØ© Ø¨Ù†Ùƒ", "ØªÙ‡Ø¯ÙŠØ¯ Ø¨Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø­Ø³Ø§Ø¨"] for f in flags):
        actions.append({"icon": "ðŸ“ž", "action": "Ø§ØªØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù†Ùƒ", "description": "Ù…Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø±Ø³Ù…ÙŠ ÙÙ‚Ø·"})
    
    if any(f["title"] in ["Ø§Ù†ØªØ­Ø§Ù„ ØµÙØ© Ù…Ø¯ÙŠØ±", "Ø§Ù†ØªØ­Ø§Ù„ Ø´Ø®ØµÙŠØ© ØµØ¯ÙŠÙ‚"] for f in flags):
        actions.append({"icon": "â˜Žï¸", "action": "ØªØ£ÙƒØ¯ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ø±Ø³Ù„", "description": "Ø§ØªØµÙ„ Ø¹Ù„ÙŠÙ‡ Ù…Ù† Ø±Ù‚Ù…Ù‡ Ø§Ù„Ù…Ø¹Ø±ÙˆÙ"})
    
    if any(f["title"] == "Ø·Ù„Ø¨ Ø±Ù…Ø² OTP/ØªØ­Ù‚Ù‚" for f in flags):
        actions.append({"icon": "ðŸ”‘", "action": "Ù„Ø§ ØªØ±Ø³Ù„ Ø±Ù…Ø² OTP", "description": "Ø§Ù„Ø±Ù…ÙˆØ² Ø´Ø®ØµÙŠØ© ÙˆÙ„Ø§ ØªÙØ´Ø§Ø±Ùƒ"})
    
    actions.append({"icon": "ðŸ—‘ï¸", "action": "Ø§Ø­Ø°Ù Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„", "description": "Ù„Ø§ ØªØ­ØªÙØ¸ Ø¨Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„"})
    actions.append({"icon": "ðŸ“£", "action": "Ø¨Ù„Ù‘Øº IT", "description": "Ø³Ø§Ø¹Ø¯ ÙÙŠ Ø­Ù…Ø§ÙŠØ© Ø²Ù…Ù„Ø§Ø¦Ùƒ"})
    
    return actions


def get_advice(score: int, text: str) -> str:
    """Ø§Ù„Ù†ØµÙŠØ­Ø©"""
    text_lower = text.lower()
    
    if score < 40:
        return "Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ÙŠØ¨Ø¯Ùˆ Ø¢Ù…Ù†Ø§Ù‹ØŒ Ù„ÙƒÙ† ØªØ£ÙƒØ¯ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø±Ø³Ù„"
    
    if any(w in text_lower for w in ["otp", "Ø±Ù…Ø²", "ÙƒÙˆØ¯"]):
        return "â›” Ù„Ø§ ØªØ±Ø³Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ OTP Ù„Ø£ÙŠ Ø´Ø®Øµ! Ø§Ù„Ø¨Ù†ÙˆÙƒ Ù„Ø§ ØªØ·Ù„Ø¨Ù‡ Ø£Ø¨Ø¯Ø§Ù‹"
    
    if any(w in text_lower for w in ["Ù…Ø¯ÙŠØ±Ùƒ", "Ø§Ù†Ø§ Ù…Ø¯ÙŠØ±Ùƒ", "Ø§Ù„Ù…Ø¯ÙŠØ±"]):
        return "â›” ØªØ£ÙƒØ¯ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ø±Ø³Ù„! Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ù† ÙŠØ·Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø±ÙŠØ© Ø¹Ø¨Ø± Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„"
    
    if any(w in text_lower for w in ["Ù…Ù† Ø§Ù„Ø¨Ù†Ùƒ", "Ù…Ù† Ø¨Ù†Ùƒ", "Ø¨Ù†Ùƒ Ø§Ù„ØªÙ†Ù…ÙŠØ©"]):
        return "â›” Ø§Ù„Ø¨Ù†ÙˆÙƒ Ù„Ø§ ØªØ·Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¹Ø¨Ø± Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„! Ø§ØªØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ù„ØªØ£ÙƒØ¯"
    
    if any(w in text_lower for w in ["Ø®ÙˆÙŠÙƒ", "ØµØ§Ø­Ø¨Ùƒ", "Ù…Ø­ØªØ§Ø¬", "Ø³Ù„ÙÙ†ÙŠ"]):
        return "ØªØ£ÙƒØ¯ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ø´Ø®Øµ Ø¨Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù‚Ø¨Ù„ Ø£ÙŠ ØªØ­ÙˆÙŠÙ„"
    
    if any(w in text_lower for w in ["Ø¥ÙŠÙ‚Ø§Ù", "ØªØ¬Ù…ÙŠØ¯", "suspended"]):
        return "Ù„Ø§ ØªØ¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ø±Ø§Ø¨Ø· ÙˆØ§ØªØµÙ„ Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø±Ø³Ù…ÙŠ"
    
    if any(w in text_lower for w in ["Ø±Ø¨Ø­Øª", "Ø¬Ø§Ø¦Ø²Ø©", "winner"]):
        return "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¬ÙˆØ§Ø¦Ø² Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø¹Ø¨Ø± Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ØŒ ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©"
    
    return "âš ï¸ ÙƒÙ† Ø­Ø°Ø±Ø§Ù‹ Ø¬Ø¯Ø§Ù‹! Ù„Ø§ ØªØ´Ø§Ø±Ùƒ Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ„Ø§ ØªØ¶ØºØ· Ø¹Ù„Ù‰ Ø±ÙˆØ§Ø¨Ø·"
